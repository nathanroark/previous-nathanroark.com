---
interface Props {
  imgSrc: string
  opacity?: number // 0â€“1
  blur?: number // px
  animated?: boolean
}
const { imgSrc, opacity = 1.0, blur = 62, animated = true } = Astro.props as Props
---

<style>
  .abs-root {
    position: absolute;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    overflow: hidden;
    width: 100%;
    height: 100%;
  }

  /* Use a single blurred background layer */
  .abs-bg {
    position: absolute;
    top: -50%;
    left: -50%;
    right: -50%;
    bottom: -50%;
    width: 200%;
    height: 200%;
    background-image: var(--abs-img);
    background-repeat: no-repeat;
    background-position: center center;
    background-size: cover;
    filter: blur(var(--abs-blur)) saturate(1.2) brightness(0.94);
    opacity: var(--abs-opacity);
    will-change: transform;
    transform-origin: center center;
  }

  /* More noticeable animation with bigger movements */
  @keyframes abs-pan {
    0% {
      transform: scale(1.08) translate(0%, 0%);
    }
    33% {
      transform: scale(1.12) translate(-2%, 1%);
    }
    66% {
      transform: scale(1.1) translate(2%, -1%);
    }
    100% {
      transform: scale(1.08) translate(0%, 0%);
    }
  }

  .abs-animated .abs-bg {
    animation: abs-pan 20s ease-in-out infinite;
  }
</style>

<div
  class={`abs-root ${animated ? 'abs-animated' : ''}`}
  style={{
    '--abs-img': `url(${imgSrc})`,
    '--abs-opacity': String(opacity),
    '--abs-blur': `${blur}px`,
  }}
>
  <div class="abs-bg" aria-hidden="true"></div>
</div>
